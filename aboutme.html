<html>
  <script type="text/template" id="vertex-shader">
    varying vec2 vUv;

    void main () {
      vec3 newPosition = position;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);

      vUv = uv;
    }
  </script>

  <script type="text/template" id="fragment-shader">
    uniform sampler2D u_texture1;
    uniform sampler2D u_texture2;
    uniform float u_time;
    uniform float u_mixFactor;

    varying vec2 vUv;

    <perlin-noise>

    void main () {
      vec2 newUv = vUv;

      newUv.x += snoise(vec2(cos(newUv.x * 0.25 + newUv.y * 0.2) * 60.0, 1.0 + u_time)) * (0.02 + u_mixFactor * 0.05);
      newUv.y += snoise(vec2(sin(newUv.x * 20.0 + newUv.y * 0.6) * 20.0, u_time)) * (0.002 + u_mixFactor * 0.05) * 3.0;

      vec4 texColor1 = texture2D(u_texture1, newUv);
      vec4 texColor2 = texture2D(u_texture2, newUv);
      gl_FragColor = mix(texColor1, texColor2, u_mixFactor);
    }
  </script>
<!--     newUv.x += snoise(vUv.yx) * snoise(vec2(newUv.x, u_time)) * 0.0025; -->




  <script type="text/template" id="perlin-glsl">

    vec3 permute(vec3 x) { return mod(((x*34.0)+1.0)*x, 289.0); }

    float snoise(vec2 v){
      const vec4 C = vec4(0.211324865405187, 0.366025403784439,
               -0.577350269189626, 0.024390243902439);
      vec2 i  = floor(v + dot(v, C.yy) );
      vec2 x0 = v -   i + dot(i, C.xx);
      vec2 i1;
      i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
      vec4 x12 = x0.xyxy + C.xxzz;
      x12.xy -= i1;
      i = mod(i, 289.0);
      vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
      + i.x + vec3(0.0, i1.x, 1.0 ));
      vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy),
        dot(x12.zw,x12.zw)), 0.0);
      m = m*m ;
      m = m*m ;
      vec3 x = 2.0 * fract(p * C.www) - 1.0;
      vec3 h = abs(x) - 0.5;
      vec3 ox = floor(x + 0.5);
      vec3 a0 = x - ox;
      m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );
      vec3 g;
      g.x  = a0.x  * x0.x  + h.x  * x0.y;
      g.yz = a0.yz * x12.xz + h.yz * x12.yw;
      return 130.0 * dot(m, g);
    }

  </script>
    <head>
      <title>About Me</title>
    </head>  
  
  <body>
    <h1>HI, I'M ALISHA</h1>
    <p1>Rising High School Senior: interested in pursuing Aersospace Engineering at college</p1>
    <br>
    <img src="images/Screen Shot 2017-07-18 at 11.53.15 AM.png" style="width: 500px; height: 500px;" align="middle"> 
    <br> 
    <br>
    <p2>Future plans: Robert J. Lang, a former physicist from NASA, decided to quit his job at NASA to pursue a career involving his passion for origami. He learned that by applying math to his origami, he would be able to create cylindrical geometries capable of fitting inside a rocket. Thus, this would provide more clear ways of folding satellites into rockets that could unfold in an organized manner once released into space. Three years ago, after watching a Facebook video publicizing this information, I was deeply inspired; I have always held fervor for anything that allowed me to work with my hands, origami being one of those activities that helped fulfill this ardor of mine. Moreover, I too have been able to experience love for physics through my physics and engineering courses at school. Thus, this Facebook video, which motivated me to enroll in the PLTW courses and Physics classes in high school, largely inspired me to pursue engineering in college. In order to accomplish my goal of working alongside minds in the realm of Robert Lang's, I hope to go to college to study physics and aerospace engineering.</p2>
    <h2>Girls Who Code: Projects</h2>
    <p3>Paddle Ball</p3>
    <br>
    <br>
    <a href="https://scratch.mit.edu/projects/168670817/">
      <img src="images/Screen Shot 2017-07-18 at 9.52.44 AM.png" style="width: 600px; height: 500px;" align="left">
    <aside1>WE MADE THIS PROJECT AND IT'S SUPER COOL DO YOU LIKE IT PLEASE SAY YOU LIKE IT FRENNN.</aside1>
    <a href="https://scratch.mit.edu/projects/168670817/">Click here to see the code!</a>
    <br>
    <br>
    <p4>Side-Scrolling Game</p4>
    <br>
    <br>
    <a href="https://scratch.mit.edu/projects/168768745/">
      <img src="images/Screen Shot 2017-07-18 at 9.41.52 AM.png" style="width: 600px; height: 500px;" align="right">
    <aside2>WE MADE THIS PROJECT AND IT'S SUPER COOL DO YOU LIKE IT PLEASE SAY YOU LIKE IT FRENNN.</aside2>
    <a href="https://scratch.mit.edu/projects/168768745/">Click here to see the code!</a>
    <br>
    <br>
    <h3>Escape Bot</h3>
    <br>
    <br>
    <h4>CONTACT ME</H4>
    <footer>Â© 2017 by Alisha Kochar</footer>
  </body>
  
  <style>
    body { margin: 0; padding: 0; 
    background-color: black;
    font-family: Verdana; 
    text-align: center;
    }
    h1 {
      color: white;
      text-align: center;
      font-size: -webkit-xxx-large;
    }
    p1 {
      color: white;
      text-align: center;
      font-size: medium;
    }
    img {
      text-align: -webkit-left;
    }
    p2 {
      color: white;
      text-align: center; 
      font-size: medium; 
    }
    h2 {
      color: white;
      text-align: center;
      font-size: -webkit-xxx-large;
    }
    p3 {
      color: white;
      text-align: center;
      font-size: xx-large;
    }
    aside1 {
      color: white;
      text-align: center;
      font-size: large;
    }
    p4 {
      color: white;
      text-align: center;
      font-size: xx-large;
    }
    aside2 {
      color: white;
      text-align: center;
      font-size: large;
    }
    h3 {
      color: white;
      text-align: center;
      font-size: xx-large;
    }
    footer {
      color: white;
      text-align: center;
      font-size: small;
    }
  </style>
  
  <style>
    a:link {
        color: white; 
        background-color: transparent; 
        text-decoration: none;
    }
    a:visited {
        color: white;
        background-color: transparent;
        text-decoration: none;
    }
    a:hover {
        color: red;
        background-color: transparent;
        text-decoration: underline;
    }
    a:active {
        color: white;
        background-color: transparent;
        text-decoration: underline;
    }
  </style>
</html>

class ClockTexture {
  constructor (width, height) {
    this.canvas = document.createElement('canvas')
    this.ctx = this.canvas.getContext('2d')
    this.width = this.canvas.width = width
    this.height = this.canvas.height = height
    
    // this.canvas.style.position = 'fixed'
    // this.canvas.style.bottom = '1rem'
    // this.canvas.style.right = '1rem'
    // document.body.appendChild(this.canvas)
  }
  getTime () {
    let date = new Date()

    let hours = date.getHours()
    let minutes = date.getMinutes()
    let seconds = date.getSeconds()

    if (hours.toString().length === 1) hours = `0${hours}`
    if (minutes.toString().length === 1) minutes = `0${minutes}`
    if (seconds.toString().length === 1) seconds = `0${seconds}`

    return `${hours}:${minutes}:${seconds}`
  }
  render () {
    this.ctx.fillStyle = '#111'
    this.ctx.fillRect(0, 0, this.width, this.height)
    this.ctx.fillStyle = '#fff'
    this.ctx.font = '120px Arial'
    this.ctx.textAlign = 'center'
    this.ctx.fillText(this.getTime(), this.width / 2, this.height / 2 + 30)
    let img = this.ctx.getImageData(0, 0, this.width, this.height)
    
    return new THREE.Texture(img)
  }
}

let width = window.innerWidth
let height = window.innerHeight

const scene = new THREE.Scene()
const camera = new THREE.PerspectiveCamera(45, width / height, 0.1, 1000)
const renderer = new THREE.WebGLRenderer()
const clock = new THREE.Clock()
const controls = new THREE.OrbitControls(camera, renderer.domElement)

// let helper = new THREE.GridHelper(200, 20)
// scene.add(helper)

let clockTexture = new ClockTexture(1024, 512)

const uniforms = {
  u_texture1:  { value: clockTexture.render() },
  u_texture2:  { value: clockTexture.render() },
  u_time:      { value: 0 }, 
  u_mixFactor: { value: 0 }
}
const perlinNoise = document.querySelector('#perlin-glsl').text
const vertexShader = document.querySelector('#vertex-shader').text
const fragmentShader = document.querySelector('#fragment-shader').text

const geometry = new THREE.PlaneBufferGeometry(200, 100)
const material = new THREE.ShaderMaterial({
  uniforms,
  vertexShader,
  fragmentShader: fragmentShader.replace(/<perlin-noise>/i, perlinNoise),
  
  side: THREE.DoubleSide
})
// const material = new THREE.MeshBasicMaterial({ color: 0xFF0000 })
const mesh = new THREE.Mesh(geometry, material)
mesh.position.set(0, 0, 0)
scene.add(mesh)

setInterval(updateClock, 500)
setScene()
renderFrame()

let clockCount = 0
function updateClock () {
  if (clockCount % 2 === 0) {
    TweenMax.to(uniforms.u_mixFactor, 0.25, { value: 1, onComplete () {
      uniforms.u_texture1.value = clockTexture.render()
    }, onProgress (e) {
      console.log(e)
    } })
  } else if (clockCount % 2 !== 0) {
    TweenMax.to(uniforms.u_mixFactor, 0.25, { value: 0, onComplete () {
      uniforms.u_texture2.value = clockTexture.render()
    } })
  }
  clockCount += 1
}

function setScene () {
  renderer.setSize(width, height)
  renderer.setClearColor(0x111111)
  renderer.setPixelRatio(window.devicePixelRatio || 1)
  document.body.appendChild(renderer.domElement)
  
  camera.position.set(0, 0, 150)
  camera.lookAt(new THREE.Vector3())
}

let time = 0
function renderFrame () {
  window.requestAnimationFrame(renderFrame)
  renderer.render(scene, camera)
  time += clock.getDelta()
  
  uniforms.u_texture1.value.needsUpdate = true
  uniforms.u_texture2.value.needsUpdate = true
  uniforms.u_time.value = time
}
